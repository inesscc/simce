
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../generar_insumos_img/">
      
      
        <link rel="next" href="../proc_imgs/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Procesamiento tabla dobles marcas - SIMCE Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#simce.proc_tabla_99" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="SIMCE Docs" class="md-header__button md-logo" aria-label="SIMCE Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SIMCE Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Procesamiento tabla dobles marcas
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Cambiar a modo oscurso"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo oscurso" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Cambiar a modo normal"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo normal" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="SIMCE Docs" class="md-nav__button md-logo" aria-label="SIMCE Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    SIMCE Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documentación Proyecto SIMCE
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial de uso
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../outputs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Guía de outputs del proyecto
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../script_configuracion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cómo utilizar el script de configuración
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Manuales de referencia
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Manuales de referencia
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generar_insumos_img/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generación de insumos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Procesamiento tabla dobles marcas
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Procesamiento tabla dobles marcas
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simce.proc_tabla_99" class="md-nav__link">
    <span class="md-ellipsis">
      proc_tabla_99
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simce.proc_tabla_99.get_tablas_99" class="md-nav__link">
    <span class="md-ellipsis">
      get_tablas_99
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simce.proc_tabla_99.get_tablas_99_total" class="md-nav__link">
    <span class="md-ellipsis">
      get_tablas_99_total
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simce.proc_tabla_99.procesar_casos_99" class="md-nav__link">
    <span class="md-ellipsis">
      procesar_casos_99
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proc_imgs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Recorte de subpreguntas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../paralelizacion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Procesamiento paralelizado
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../predicciones/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Predicción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../indicadores_tinta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Indicadores de tinta
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Funciones transversales
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simce.proc_tabla_99" class="md-nav__link">
    <span class="md-ellipsis">
      proc_tabla_99
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simce.proc_tabla_99.get_tablas_99" class="md-nav__link">
    <span class="md-ellipsis">
      get_tablas_99
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simce.proc_tabla_99.get_tablas_99_total" class="md-nav__link">
    <span class="md-ellipsis">
      get_tablas_99_total
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simce.proc_tabla_99.procesar_casos_99" class="md-nav__link">
    <span class="md-ellipsis">
      procesar_casos_99
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Procesamiento tabla dobles marcas</h1>

<p>En este manual se repasan las funciones asociadas a la generación de la tabla que contiene una fila por cada subpregunta con posible doble marca, desde las tablas Origen presentadas originalmente por la ACE.</p>


<div class="doc doc-object doc-module">



<a id="simce.proc_tabla_99"></a>
    <div class="doc doc-contents first">

        <p>Created on Thu May  9 17:20:37 2024</p>
<p>@author: jeconchao</p>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="simce.proc_tabla_99.get_tablas_99" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_tablas_99</span><span class="p">(</span><span class="n">tipo_cuadernillo</span><span class="p">,</span> <span class="n">directorios</span><span class="p">,</span> <span class="n">limpiar_ruta</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Genera tabla de dobles marcas para un tipo de cuadernillo específico, donde cada fila es una
  subpregunta con sospecha de doble marca. Utiliza insumos generados en 
  <a href="../generar_insumos_img#simce.generar_insumos_img">su respectivo módulo</a> para determinar a cuál de las
   imágenes pertenece cada subpregunta, lo que posteriormente permite cargar la imagen correcta en 
   <a href="../paralelizacion#simce.paralelizacion">el módulo de paralelización</a>. <strong>No retorna nada</strong>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>tipo_cuadernillo</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>cuadernillo siendo analizado, puede ser "estudiantes" o "padres".</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>directorios</code></td>
            <td>
                  <code>list[<span title="os.PathLike">PathLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>lista de directorios del proyecto.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>limpiar_ruta</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>booleando que define si la ruta debe limpiarse. En particular, a veces las rutas llegan
con la serie del estudiante dentro de esta. En general, el proyecto se realiza de forma que dentro
de cada rbd están las imágenes de todos los estudiantes, por lo que damos la opción de borrar
la serie de la ruta.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>simce\proc_tabla_99.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_tablas_99</span><span class="p">(</span><span class="n">tipo_cuadernillo</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">directorios</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">PathLike</span><span class="p">],</span> <span class="n">limpiar_ruta</span><span class="p">:</span><span class="nb">bool</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Genera tabla de dobles marcas para un tipo de cuadernillo específico, donde cada fila es una</span>
<span class="sd">      subpregunta con sospecha de doble marca. Utiliza insumos generados en </span>
<span class="sd">      [su respectivo módulo](../generar_insumos_img#simce.generar_insumos_img) para determinar a cuál de las</span>
<span class="sd">       imágenes pertenece cada subpregunta, lo que posteriormente permite cargar la imagen correcta en </span>
<span class="sd">       [el módulo de paralelización](../paralelizacion#simce.paralelizacion). **No retorna nada**.</span>

<span class="sd">    Args:</span>
<span class="sd">        tipo_cuadernillo: cuadernillo siendo analizado, puede ser &quot;estudiantes&quot; o &quot;padres&quot;.</span>
<span class="sd">        directorios: lista de directorios del proyecto.</span>
<span class="sd">        limpiar_ruta: booleando que define si la ruta debe limpiarse. En particular, a veces las rutas llegan</span>
<span class="sd">            con la serie del estudiante dentro de esta. En general, el proyecto se realiza de forma que dentro</span>
<span class="sd">            de cada rbd están las imágenes de todos los estudiantes, por lo que damos la opción de borrar</span>
<span class="sd">            la serie de la ruta.</span>
<span class="sd">         &#39;&#39;&#39;</span>


    <span class="n">nombre_tabla_origen</span> <span class="o">=</span> <span class="n">nombres_tablas_origen</span><span class="p">[</span><span class="n">tipo_cuadernillo</span><span class="p">]</span>


    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">directorios</span><span class="p">[</span><span class="s1">&#39;dir_insumos&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="s1">&#39;insumos.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">insumos</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">tipo_cuadernillo</span> <span class="ow">in</span> <span class="n">insumos</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No hay tabla de padres para este curso&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>
    <span class="n">dic_cuadernillo</span> <span class="o">=</span> <span class="n">insumos</span><span class="p">[</span><span class="n">tipo_cuadernillo</span><span class="p">][</span><span class="s1">&#39;dic_cuadernillo&#39;</span><span class="p">]</span>


    <span class="n">Origen_DobleMarca</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">directorios</span><span class="p">[</span><span class="s1">&#39;dir_input&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">nombre_tabla_origen</span><span class="p">,</span>
                                     <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">ENCODING</span><span class="p">)</span>



    <span class="n">nombres_col</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">Origen_DobleMarca</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;p\d+&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">)]</span>

    <span class="n">casos_99_origen</span> <span class="o">=</span> <span class="n">procesar_casos_99</span><span class="p">(</span><span class="n">Origen_DobleMarca</span><span class="p">,</span> <span class="n">nombres_col</span><span class="p">,</span> <span class="n">dic_cuadernillo</span><span class="p">,</span>
                                        <span class="n">tipo_cuadernillo</span><span class="p">)</span>

    <span class="n">casos_99_origen</span> <span class="o">=</span> <span class="n">casos_99_origen</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;respuestas&#39;</span><span class="p">:</span> <span class="s1">&#39;dm_sospecha&#39;</span><span class="p">})</span>


    <span class="n">casos_99_origen</span><span class="p">[</span><span class="s1">&#39;rbd_ruta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">casos_99_origen</span><span class="o">.</span><span class="n">ruta_imagen</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;string&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">regex_extraer_rbd_de_ruta</span><span class="p">)</span>

    <span class="n">df_final</span> <span class="o">=</span> <span class="n">casos_99_origen</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">limpiar_ruta</span><span class="p">:</span>
        <span class="n">df_final</span><span class="o">.</span><span class="n">ruta_imagen</span> <span class="o">=</span> <span class="n">df_final</span><span class="o">.</span><span class="n">ruta_imagen</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">\d</span><span class="si">{7}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">df_final</span><span class="p">[</span><span class="s1">&#39;ruta_imagen_output&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">directorios</span><span class="p">[</span><span class="s1">&#39;dir_subpreg&#39;</span><span class="p">]</span> <span class="o">/</span> 
                                      <span class="n">df_final</span><span class="o">.</span><span class="n">ruta_imagen</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;^/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                                      <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">Path</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">/</span>
                                        <span class="p">(</span><span class="n">df_final</span><span class="o">.</span><span class="n">serie</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">df_final</span><span class="o">.</span><span class="n">preguntas</span> <span class="o">+</span> <span class="s1">&#39;.jpg&#39;</span><span class="p">)</span> <span class="p">)</span>



    <span class="n">df_final</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
        <span class="n">directorios</span><span class="p">[</span><span class="s1">&#39;dir_tabla_99&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;casos_99_compilados_</span><span class="si">{</span><span class="n">CURSO</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">tipo_cuadernillo</span><span class="si">}</span><span class="s1">.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tabla compilada generada exitosamente!&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simce.proc_tabla_99.get_tablas_99_total" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_tablas_99_total</span><span class="p">(</span><span class="n">directorios</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Obtiene y exporta tabla de dobles marcas para estudiantes y padres.
    <strong>No retorna nada</strong></p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>directorios</code></td>
            <td>
                  <code>list[<span title="os.PathLike">PathLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>lista de directorios del proyecto.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>simce\proc_tabla_99.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@timing</span>
<span class="k">def</span> <span class="nf">get_tablas_99_total</span><span class="p">(</span><span class="n">directorios</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">PathLike</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Obtiene y exporta tabla de dobles marcas para estudiantes y padres.</span>
<span class="sd">        **No retorna nada**</span>

<span class="sd">    Args:</span>
<span class="sd">        directorios: lista de directorios del proyecto.&#39;&#39;&#39;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Generando tabla estudiantes...&#39;</span><span class="p">)</span>

    <span class="n">get_tablas_99</span><span class="p">(</span><span class="n">tipo_cuadernillo</span><span class="o">=</span><span class="s1">&#39;estudiantes&#39;</span><span class="p">,</span> 
                  <span class="n">directorios</span><span class="o">=</span><span class="n">directorios</span><span class="p">,</span> <span class="n">limpiar_ruta</span><span class="o">=</span><span class="n">LIMPIAR_RUTA</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Generando tabla padres...&#39;</span><span class="p">)</span>

    <span class="n">get_tablas_99</span><span class="p">(</span><span class="n">tipo_cuadernillo</span><span class="o">=</span><span class="s1">&#39;padres&#39;</span><span class="p">,</span> 
                  <span class="n">directorios</span><span class="o">=</span><span class="n">directorios</span><span class="p">,</span> <span class="n">limpiar_ruta</span><span class="o">=</span><span class="n">LIMPIAR_RUTA</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="simce.proc_tabla_99.procesar_casos_99" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">procesar_casos_99</span><span class="p">(</span><span class="n">tabla_origen</span><span class="p">,</span> <span class="n">nombres_col</span><span class="p">,</span> <span class="n">dic_cuadernillo</span><span class="p">,</span> <span class="n">tipo_cuadernillo</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Procesa tabla de origen, de forma que cada fila represente una subpregunta con sospecha de doble marca.
Además, identifica a cuál imagen corresponde la subpregunta.  </p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>tabla_origen</code></td>
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tabla Origen proporcionada por ACE. Contiene las respuestas de todos los alumnos que tienen
al menos una sospecha de doble marca.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>nombres_col</code></td>
            <td>
                  <code>list[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>lista de nombres de columnas asociados a preguntas en la tabla de Origen.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>dic_cuadernillo</code></td>
            <td>
                  <code>dict[str, int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>diccionario que indica a qué imagen corresponde cada pregunta del cuadernillo.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>tipo_cuadernillo</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tipo de cuadernillo siendo analizado, puede ser "estudiantes" o "padres"</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>casos_99_final</code></td>            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tabla dobles marcas procesada, tal que cada fila represente
una subpregunta con sospecha de doble marca</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>simce\proc_tabla_99.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">procesar_casos_99</span><span class="p">(</span><span class="n">tabla_origen</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">nombres_col</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">dic_cuadernillo</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span>
                       <span class="n">tipo_cuadernillo</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Procesa tabla de origen, de forma que cada fila represente una subpregunta con sospecha de doble marca.</span>
<span class="sd">    Además, identifica a cuál imagen corresponde la subpregunta.  </span>

<span class="sd">    Args:</span>
<span class="sd">        tabla_origen: tabla Origen proporcionada por ACE. Contiene las respuestas de todos los alumnos que tienen</span>
<span class="sd">            al menos una sospecha de doble marca.</span>
<span class="sd">        nombres_col: lista de nombres de columnas asociados a preguntas en la tabla de Origen.</span>
<span class="sd">        dic_cuadernillo: diccionario que indica a qué imagen corresponde cada pregunta del cuadernillo.</span>
<span class="sd">        tipo_cuadernillo: tipo de cuadernillo siendo analizado, puede ser &quot;estudiantes&quot; o &quot;padres&quot;</span>

<span class="sd">    Returns:</span>
<span class="sd">        casos_99_final: tabla dobles marcas procesada, tal que cada fila represente</span>
<span class="sd">            una subpregunta con sospecha de doble marca</span>


<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">ignorar_p1</span> <span class="o">=</span> <span class="n">dic_ignorar_p1</span><span class="p">[</span><span class="n">tipo_cuadernillo</span><span class="p">]</span>

    <span class="n">df_melt</span> <span class="o">=</span> <span class="n">tabla_origen</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="n">variables_identificadoras</span><span class="p">,</span>
                            <span class="n">value_vars</span><span class="o">=</span><span class="n">nombres_col</span><span class="p">,</span>
                            <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;preguntas&#39;</span><span class="p">,</span>
                            <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;respuestas&#39;</span><span class="p">)</span>
    <span class="c1"># Si pregunta 1 debe ser ignorada, la sacamos de la base:</span>
    <span class="k">if</span> <span class="n">ignorar_p1</span><span class="p">:</span>
        <span class="n">df_melt</span> <span class="o">=</span> <span class="n">df_melt</span><span class="p">[</span><span class="n">df_melt</span><span class="o">.</span><span class="n">preguntas</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">regex_p1</span><span class="p">)]</span>

    <span class="n">casos_99</span> <span class="o">=</span> <span class="n">df_melt</span><span class="p">[(</span><span class="n">df_melt</span><span class="p">[</span><span class="s1">&#39;respuestas&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">99</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Si queremos obtener set de entrenamiento agregamos muestra de respuestas normales:</span>

    <span class="c1"># Usamos diccionario cuadernillo para ver a qué imagen está asociada esa pregunta específica:</span>
    <span class="n">casos_99</span><span class="p">[</span><span class="s1">&#39;ruta_imagen&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">casos_99</span><span class="o">.</span><span class="n">rutaImagen1</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(_\d+.*)&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">+</span>
                               <span class="n">casos_99</span><span class="o">.</span><span class="n">preguntas</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(p\d+)&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">dic_cuadernillo</span><span class="p">)</span> <span class="o">+</span>
                               <span class="s1">&#39;.jpg&#39;</span><span class="p">)</span>
    <span class="n">casos_99_final</span> <span class="o">=</span> <span class="n">casos_99</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rutaImagen1&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;serie&#39;</span><span class="p">,</span> <span class="s1">&#39;preguntas&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">casos_99_final</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56dfad97.min.js"></script>
      
    
  </body>
</html>